/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torchvision/transforms/v2/_deprecated.py:42: UserWarning: The transform `ToTensor()` is deprecated and will be removed in a future release. Instead, please use `v2.Compose([v2.ToImage(), v2.ToDtype(torch.float32, scale=True)])`.Output is equivalent up to float precision.
  warnings.warn(
2024-06-18 02:48:45.238300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
Files already downloaded and verified
  0%|          | 0/100 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/share/castor/home/duong/Membership-Inference-Attack/main_cen.py", line 24, in <module>
    cenModel = trainModel(cenTrainDataLoader, device, dataCIFARonline.__CIFAR10_N_CLASSES__, backbone)
  File "/share/castor/home/duong/Membership-Inference-Attack/utils.py", line 19, in trainModel
    trainModelWithModel(dataLoader, device, model, epochs, verbose)
  File "/share/castor/home/duong/Membership-Inference-Attack/utils.py", line 29, in trainModelWithModel
    torchtnt.framework.train(train_unit, dataLoader, max_epochs=epochs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torchtnt/framework/train.py", line 113, in train
    raise e
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torchtnt/framework/train.py", line 102, in train
    _train_impl(state, train_unit, callback_handler)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torchtnt/framework/train.py", line 148, in _train_impl
    _train_epoch_impl(state, train_unit, callback_handler)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torchtnt/framework/train.py", line 215, in _train_epoch_impl
    train_state._step_output = train_unit.train_step(state, step_input)
  File "/share/castor/home/duong/Membership-Inference-Attack/model/unit.py", line 39, in train_step
    outputs = self.module(inputs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/share/castor/home/duong/Membership-Inference-Attack/model/ModelFromBackbone.py", line 19, in forward
    return self.backbone(x)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torchvision/models/resnet.py", line 268, in _forward_impl
    x = self.conv1(x)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/share/home/duong/.conda/envs/ffyytt/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
  0%|          | 0/100 [00:00<?, ?it/s]
